"use strict";(self["webpackChunkjcrew"]=self["webpackChunkjcrew"]||[]).push([[14],{9014:function(t,e,s){s.r(e),s.d(e,{default:function(){return n}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pt-5"},[s("ul",{staticClass:"mb-4 step"},[s("li",{staticClass:"bg-light",class:{"bg-dark text-light active":1===t.step}},[s("strong",[t._v("STEP")]),t._m(0),s("p",{staticClass:"h6"},[t._v("確認購物清單")])]),s("li",{staticClass:"bg-light",class:{"bg-dark text-light active":2===t.step}},[s("strong",[t._v("STEP")]),t._m(1),s("p",{staticClass:"h6"},[t._v("填寫訂購資料")])]),s("li",{staticClass:"bg-light",class:{"bg-dark text-light active":3===t.step}},[s("strong",[t._v("STEP")]),t._m(2),s("p",{staticClass:"h6"},[t._v("付款/完成訂單")])])]),1===t.step?s("div",{staticClass:"table-responsive"},[s("table",{staticClass:"table mb-4"},[t._m(3),s("tbody",t._l(t.carts.carts,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"d-md-table-cell text-center d-none"},[s("div",{staticClass:"thumbnail",style:{backgroundImage:"url("+e.product.imageUrl+")"}})]),s("td",{},[t._v(" "+t._s(e.product.title)+"("+t._s(e.size)+") "),e.coupon?s("div",{staticClass:"text-success mt-2"},[t._v(" 已套用折價卷 - ["+t._s(e.coupon.code)+"] ")]):t._e()]),s("td",{staticClass:"d-sm-table-cell d-none text-center"},[t._v(" "+t._s(e.qty)+" / "+t._s(e.product.unit)+" ")]),s("td",{staticClass:"text-right"},[e.coupon?s("div",[s("del",[t._v(t._s(t._f("currency")(e.total)))]),s("div",{staticClass:"text-success mt-2"},[t._v(" "+t._s(t._f("currency")(e.final_total))+" ")])]):s("div",[t._v(" "+t._s(t._f("currency")(e.total))+" ")])]),t._m(4,!0)])})),0),s("tfoot",{staticClass:"border-top table-borderless bg-light"},[s("tr",[s("td",{staticClass:"d-sm-table-cell d-none"}),s("td",{staticClass:"d-sm-table-cell d-none"}),s("td",{staticClass:"text-right"},[t._v(" 共 "+t._s(t.cartsLength)+" 件 ")]),s("td",{staticClass:"text-right"},[t._v(" 運費 ")]),s("td",{staticClass:"text-right"},[t._v(" $60 ")])]),s("tr",[s("td",{staticClass:"d-sm-table-cell d-none"}),s("td",{staticClass:"d-sm-table-cell d-none"}),s("td",{staticClass:"text-right",attrs:{colspan:"2"}},[t._v(" 總計 ")]),s("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("currency")(t.carts.total))+" ")])]),t.carts.total!==t.carts.final_total?s("tr",{staticClass:"text-success"},[s("td",{staticClass:"d-sm-table-cell d-none"}),s("td",{staticClass:"d-sm-table-cell d-none"}),s("td",{staticClass:"text-right",attrs:{colspan:"2"}},[t._v(" 折扣後金額 ")]),s("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("currency")(t.carts.final_total))+" ")])]):t._e()])]),s("div",{staticClass:"mb-4 stepBtn"},[s("router-link",{staticClass:"btn btn-secondary",attrs:{to:"/productslist"}},[s("i",{staticClass:"fas fa-arrow-left"}),t._v(" 繼續購買 ")]),s("a",{staticClass:"btn btn-danger d-inline-block",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.step=2}}},[t._v(" 下一步，填寫訂購資料 "),s("i",{staticClass:"fas fa-arrow-right"})])],1)]):t._e(),2===t.step?s("div",{staticClass:"mb-4"},[s("div",{attrs:{id:"accordion"}},[s("div",{staticClass:"card mb-4"},[t._m(5),s("div",{staticClass:"collapse border-top",attrs:{id:"collapseOne","aria-labelledby":"headingOne","data-parent":"#accordion"}},[s("div",{staticClass:"card-body"},[s("table",{staticClass:"table"},[t._m(6),s("tbody",t._l(t.carts.carts,(function(e){return s("tr",{key:e.id},[s("td",[t._v(" "+t._s(e.product.title)+" ("+t._s(e.size)+")")]),s("td",[t._v(" "+t._s(e.qty)+" / "+t._s(e.product.unit))]),s("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(e.final_total)))])])})),0),s("tfoot",[s("tr",[s("td"),s("td",[t._v("總計")]),s("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.carts.final_total)))])])])])])])])]),s("div",[s("h5",{staticClass:"text-center"},[t._v("訂購資料")]),s("form",{on:{submit:function(e){return e.preventDefault(),t.createOrder.apply(null,arguments)}}},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"email"}},[t._v("Email")]),s("input",{directives:[{name:"validate",rawName:"v-validate",value:"required|email",expression:"'required|email'"},{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"}],staticClass:"form-control",class:{"is-invalid":t.errors.first("email")},attrs:{type:"email",name:"email",id:"email",placeholder:"請輸入 Email"},domProps:{value:t.form.user.email},on:{input:function(e){e.target.composing||t.$set(t.form.user,"email",e.target.value)}}}),t.errors.first("email")?s("span",{staticClass:"text-danger"},[t._v(" "+t._s(t.errors.first("email"))+" ")]):t._e()]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"name"}},[t._v("收件人姓名")]),s("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("name")},attrs:{type:"text",name:"name",id:"name",placeholder:"請輸入 收件人姓名"},domProps:{value:t.form.user.name},on:{input:function(e){e.target.composing||t.$set(t.form.user,"name",e.target.value)}}}),t.errors.has("name")?s("span",{staticClass:"text-danger"},[t._v("姓名欄位不得留空")]):t._e()]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"tel"}},[t._v("收件人電話")]),s("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("tel")},attrs:{type:"tel",name:"tel",id:"tel",placeholder:"請輸入收寄人電話"},domProps:{value:t.form.user.tel},on:{input:function(e){e.target.composing||t.$set(t.form.user,"tel",e.target.value)}}}),t.errors.has("tel")?s("span",{staticClass:"text-danger"},[t._v("電話欄位不得留空")]):t._e()]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:"address"}},[t._v("收件人地址")]),s("input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"},{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("address")},attrs:{type:"text",name:"address",id:"address",placeholder:"請輸入收件人地址"},domProps:{value:t.form.user.address},on:{input:function(e){e.target.composing||t.$set(t.form.user,"address",e.target.value)}}}),t.errors.has("address")?s("span",{staticClass:"text-danger"},[t._v("地址欄位不得留空")]):t._e()]),s("div",{staticClass:"form-group mb-4"},[s("label",{attrs:{for:"message"}},[t._v("留言")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{name:"message",id:"message",cols:"20",rows:"5"},domProps:{value:t.form.message},on:{input:function(e){e.target.composing||t.$set(t.form,"message",e.target.value)}}})]),s("div",{staticClass:"stepBtn"},[s("a",{staticClass:"btn btn-success",attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.step=1}}},[s("i",{staticClass:"fas fa-arrow-left"}),t._v(" 回上一步 ")]),t._m(7)])])])]):t._e(),3===t.step?s("div",{staticClass:"mb-4"},[s("form",{on:{submit:function(e){return e.preventDefault(),t.payOrder.apply(null,arguments)}}},[s("table",{staticClass:"table mb-3"},[t._m(8),s("tbody",t._l(t.order.products,(function(e){return s("tr",{key:e.id},[s("td",[t._v(" "+t._s(e.product.title)+" ("+t._s(e.size)+")")]),s("td",[t._v(t._s(e.qty)+" / "+t._s(e.product.unit))]),s("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(e.total)))])])})),0),s("tfoot",[s("tr",{staticClass:"text-success"},[s("td"),s("td",[t._v("總計")]),s("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.order.total)))])])])]),s("table",{staticClass:"table mb-3"},[s("tr",[s("th",{attrs:{width:"150"}},[t._v("訂購人Email")]),s("td",[t._v(t._s(t.order.user.email))])]),s("tr",[s("th",[t._v("訂購人姓名")]),s("td",[t._v(t._s(t.order.user.name))])]),s("tr",[s("th",[t._v("訂購人電話")]),s("td",[t._v(t._s(t.order.user.tel))])]),s("tr",[s("th",[t._v("留言")]),s("td",[t._v(t._s(t.order.user.message))])]),s("tr",[s("th",[t._v("付款狀態")]),t.order.is_paid?s("td",{staticClass:"text-success"},[t._v("付款成功")]):s("td",[t._v("尚未付款")])])]),t.order.is_paid?t._e():s("div",{staticClass:"text-right"},[s("button",{staticClass:"btn btn-danger"},[t._v("確認付款去")])])])]):t._e()])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h3",[s("strong",[t._v("01")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h3",[s("strong",[t._v("02")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("h3",[s("strong",[t._v("03")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",{staticClass:"d-md-table-cell d-none text-center",attrs:{width:"20%"}},[t._v("縮圖")]),s("th",{},[t._v("商品名稱")]),s("th",{staticClass:"d-sm-table-cell d-none text-center",attrs:{width:"20%"}},[t._v("數量")]),s("th",{staticClass:"text-center ",attrs:{width:"15%"}},[t._v("價格")]),s("th",{staticClass:"text-center",attrs:{width:"15%"}},[t._v("刪除")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("td",{staticClass:"text-center"},[s("a",{staticClass:"text-danger",attrs:{href:""}},[s("i",{staticClass:"fas fa-trash-alt"})])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"bg-light p-2",attrs:{id:"headingOne"}},[s("h5",{staticClass:"mb-0"},[s("button",{staticClass:"btn btn-link",attrs:{"data-toggle":"collapse","data-target":"#collapseOne","aria-expanded":"true","aria-controls":"collapseOne"}},[t._v(" 購物車清單 "),s("i",{staticClass:"fas fa-caret-down"})])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("td",[t._v("商品")]),s("td",{attrs:{width:"25%"}},[t._v("數量")]),s("td",{attrs:{width:"15%"}},[t._v("價格")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("button",{staticClass:"btn btn-danger float-right"},[t._v(" 確認訂購 "),s("i",{staticClass:"fas fa-arrow-right"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("商品")]),s("th",{attrs:{width:"25%"}},[t._v("數量")]),s("th",{attrs:{width:"15%"}},[t._v("價格")])])])}],l=s(629),i={data(){return{step:1,couponCode:"",form:{user:{name:"",email:"",tel:"",address:""},message:""},orderId:"",order:{user:{name:"",email:"",tel:"",address:""}}}},computed:{...(0,l.Se)("cartModules",["carts","cartsLength"])},methods:{removeCartItem(t){this.$store.dispatch("cartModules/removeCartItem",t)},createOrder(){const t=this,e="https://vue-course-api.hexschool.io/api/jcrewpractice/order",s=t.form;t.$validator.validate().then((a=>{a?t.$http.post(e,{data:s}).then((e=>{t.orderId=e.data.orderId,console.log(e.data.orderId),t.getOrder(),t.step=3})):t.$store.dispatch("alertMessageModules/updateMessage",{message:"欄位不完整",status:"danger"})}))},getOrder(){const t=this,e=`https://vue-course-api.hexschool.io/api/jcrewpractice/order/${t.orderId}`;t.$http.get(e).then((e=>{console.log(e.data.order),t.order=e.data.order}))},payOrder(){const t=this,e=`https://vue-course-api.hexschool.io/api/jcrewpractice/pay/${t.orderId}`;t.$http.post(e).then((e=>{e.data.success?(t.$store.dispatch("alertMessageModules/updateMessage",{message:e.data.message,status:"success"}),t.getOrder()):t.$store.dispatch("alertMessageModules/updateMessage",{message:e.data.message,status:"danger"})}))},...(0,l.nv)("cartModules",["getCart"])},watch:{order:function(){const t=this;t.$store.dispatch("cartModules/getCart")}},created(){}},c=i,o=s(1001),d=(0,o.Z)(c,a,r,!1,null,"5cd9ef23",null),n=d.exports}}]);
//# sourceMappingURL=14.35714a53.js.map